<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AQual</title>
    <link rel="stylesheet" href="popup.css" />
    <script src="popup.js" defer></script>
  </head>
  <body>
    <main class="panel is-loading" id="popupPanel">
      <section class="popup-loading-screen" id="popupLoadingScreen" role="status" aria-live="polite">
        <div class="popup-loading-card">
          <div class="popup-loading-spinner" aria-hidden="true"></div>
          <div class="popup-loading-title">Loading AQual</div>
          <div class="popup-loading-subtitle">Preparing accessibility controls.</div>
        </div>
      </section>
      <header class="app-header">
        <div class="app-title-group">
          <div class="app-title">AQual</div>
          <div class="app-subtitle">Visual accessibility controls</div>
        </div>
        <div class="app-header-actions">
          <button class="theme-toggle about-toggle" id="aboutToggle" aria-expanded="false">About</button>
          <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">Light</button>
        </div>
      </header>

      <section class="about-panel" id="aboutPanel" hidden>
        <div class="about-card">
          <div class="about-title">About AQual</div>
          <div class="about-description">AQual is a browser extension that adapts webpages for clearer reading, better focus, and easier visual access.</div>
          <div class="about-maker">Made by Shlok Gupta</div>
          <a
            class="about-linkedin"
            href="https://www.linkedin.com/in/shlokg"
            target="_blank"
            rel="noopener noreferrer"
          >
            <img src="LinkedIn_logo_initials.png" alt="" class="about-linkedin-logo" />
            <span class="about-linkedin-text">linkedin.com/in/shlokg</span>
          </a>
          <a
            class="about-linkedin"
            href="https://aqual-priv.netlify.app/"
            target="_blank"
            rel="noopener noreferrer"
          >
            <span class="about-linkedin-text">Privacy Policy</span>
          </a>
        </div>
        <button class="action-button about-back" id="aboutBackButton" type="button">Back</button>
      </section>

      <div class="tab-bar">
        <button class="tab-button active" data-tab="visual">Visual</button>
        <button class="tab-button" data-tab="audio">Audio</button>
      </div>

      <div class="tab-panel active" id="tab-visual">
        <div class="visual-search">
          <input
            type="search"
            id="visualSearchInput"
            class="search-input"
            placeholder="Search visual features..."
            autocomplete="off"
            spellcheck="false"
          />
          <div class="search-empty" id="visualSearchEmpty" hidden>No matching features.</div>
        </div>

        <details class="group" id="section-reading" open>
          <summary>Reading &amp; Text</summary>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Font family</div>
            <div class="control-subtitle">Pick a readable font for all text.</div>
          </div>
          <div class="control-actions">
            <select id="fontFamilySelect" class="select"></select>
            <label class="switch">
              <input type="checkbox" id="fontEnabled" />
              <span class="switch-track"></span>
              <span class="switch-state" id="fontEnabledState">Off</span>
            </label>
          </div>
        </div>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Font size</div>
            <div class="control-subtitle">Scale text for comfortable reading.</div>
          </div>
          <div class="control-actions">
            <div class="range">
              <input
                type="range"
                id="fontSizeRange"
                min="1"
                max="100"
                value="50"
              />
              <div class="range-value" id="fontSizeValue">50px</div>
            </div>
            <label class="switch">
              <input type="checkbox" id="fontSizeEnabled" />
              <span class="switch-track"></span>
              <span class="switch-state" id="fontSizeEnabledState">Off</span>
            </label>
          </div>
        </div>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Font colour</div>
            <div class="control-subtitle">Choose a high-contrast text colour.</div>
          </div>
          <div class="control-actions column">
            <div class="palette" id="fontColorPalette"></div>
            <label class="switch">
              <input type="checkbox" id="fontColorEnabled" />
              <span class="switch-track"></span>
              <span class="switch-state" id="fontColorEnabledState">Off</span>
            </label>
          </div>
        </div>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Text stroke</div>
            <div class="control-subtitle">Outline letters for stronger contrast.</div>
          </div>
          <div class="control-actions column">
            <div class="palette" id="textStrokePalette"></div>
            <label class="switch">
              <input type="checkbox" id="textStrokeEnabled" />
              <span class="switch-track"></span>
              <span class="switch-state" id="textStrokeEnabledState">Off</span>
            </label>
          </div>
        </div>
        <div class="control">
          <div class="control-info">
            <div class="control-title">Reduced text crowding</div>
            <div class="control-subtitle">Add spacing to improve readability.</div>
          </div>
          <div class="control-actions">
            <label class="switch">
              <input type="checkbox" id="reducedCrowdingEnabled" />
              <span class="switch-track"></span>
              <span class="switch-state" id="reducedCrowdingEnabledState">Off</span>
            </label>
          </div>
        </div>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Emphasise links</div>
            <div class="control-subtitle">Add a multicolour underline.</div>
          </div>
          <div class="control-actions">
            <label class="switch">
              <input type="checkbox" id="linkEmphasisEnabled" />
              <span class="switch-track"></span>
              <span class="switch-state" id="linkEmphasisEnabledState">Off</span>
            </label>
          </div>
        </div>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Pointer style</div>
            <div class="control-subtitle">Pick a larger, clearer pointer.</div>
          </div>
          <div class="control-actions">
            <select id="cursorTypeSelect" class="select"></select>
            <label class="switch">
              <input type="checkbox" id="cursorEnabled" />
              <span class="switch-track"></span>
              <span class="switch-state" id="cursorEnabledState">Off</span>
            </label>
          </div>
        </div>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Reading mode (AI)</div>
            <div class="control-subtitle">Use AI to keep core article content and hide clutter.</div>
          </div>
          <div class="control-actions">
            <label class="switch">
              <input type="checkbox" id="readingModeEnabled" />
              <span class="switch-track"></span>
              <span class="switch-state" id="readingModeEnabledState">Off</span>
            </label>
          </div>
        </div>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Reading Assist</div>
            <div class="control-subtitle">Upload a Document and open the Reading Assist viewer.</div>
          </div>
          <div class="control-actions column">
            <input class="file-input" type="file" id="docUploadInput" accept=".docx" />
            <button class="action-button" id="docUploadButton">Upload &amp; Open</button>
            <div class="status-text" id="docUploadStatus">Waiting for a file.</div>
          </div>
        </div>
        </details>

        <details class="group" id="section-focus" open>
          <summary>Focus &amp; Clarity</summary>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Image veil</div>
            <div class="control-subtitle">Replace images with alt text boxes.</div>
          </div>
          <div class="control-actions">
            <label class="switch">
              <input type="checkbox" id="imageVeilEnabled" />
              <span class="switch-track"></span>
              <span class="switch-state" id="imageVeilEnabledState">Off</span>
            </label>
          </div>
        </div>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Highlight words</div>
            <div class="control-subtitle">Hover to highlight each word.</div>
          </div>
          <div class="control-actions">
            <label class="switch">
              <input type="checkbox" id="highlightEnabled" />
              <span class="switch-track"></span>
              <span class="switch-state" id="highlightEnabledState">Off</span>
            </label>
          </div>
        </div>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Line Guidance</div>
            <div class="control-subtitle">Follow a moving gradient reading line (Alt+B).</div>
          </div>
          <div class="control-actions">
            <label class="switch">
              <input type="checkbox" id="lineGuideEnabled" />
              <span class="switch-track"></span>
              <span class="switch-state" id="lineGuideEnabledState">Off</span>
            </label>
          </div>
        </div>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Draw on page</div>
            <div class="control-subtitle">Annotate the page; drawings move with scroll.</div>
          </div>
          <div class="control-actions">
            <label class="switch">
              <input type="checkbox" id="drawingEnabled" />
              <span class="switch-track"></span>
              <span class="switch-state" id="drawingEnabledState">Off</span>
            </label>
          </div>
        </div>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Clear drawings</div>
            <div class="control-subtitle">Remove all annotations on this page.</div>
          </div>
          <div class="control-actions">
            <button class="action-button" id="clearDrawings">Clear</button>
          </div>
        </div>
        </details>

        <details class="group" id="section-images">
          <summary>Images</summary>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Magnifier</div>
            <div class="control-subtitle">Hover over images to zoom details.</div>
          </div>
          <div class="control-actions">
            <label class="switch">
              <input type="checkbox" id="magnifierEnabled" />
              <span class="switch-track"></span>
              <span class="switch-state" id="magnifierEnabledState">Off</span>
            </label>
          </div>
        </div>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Magnifier size</div>
            <div class="control-subtitle">Adjust the lens diameter.</div>
          </div>
          <div class="control-actions">
            <div class="range">
              <input
                type="range"
                id="magnifierSizeRange"
                min="20"
                max="100"
                step="10"
                value="50"
              />
              <div class="range-value" id="magnifierSizeValue">50px</div>
            </div>
          </div>
        </div>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Magnification</div>
            <div class="control-subtitle">Set the zoom strength.</div>
          </div>
          <div class="control-actions">
            <div class="range">
              <input
                type="range"
                id="magnifierZoomRange"
                min="1"
                max="5"
                step="1"
                value="3"
              />
              <div class="range-value" id="magnifierZoomValue">3x</div>
            </div>
          </div>
        </div>
        </details>

        <details class="group" id="section-contrast">
          <summary>Display &amp; Colour</summary>

        <div class="control">
          <div class="control-info">
            <div class="control-title">High contrast</div>
            <div class="control-subtitle">WCAG-inspired contrast boost for text and images.</div>
          </div>
          <div class="control-actions">
            <label class="switch">
              <input type="checkbox" id="highContrastEnabled" />
              <span class="switch-track"></span>
              <span class="switch-state" id="highContrastEnabledState">Off</span>
            </label>
          </div>
        </div>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Colour vision mode</div>
            <div class="control-subtitle">Adjust hues for specific colour blindness.</div>
          </div>
          <div class="control-actions">
            <select id="colorBlindModeSelect" class="select"></select>
          </div>
        </div>

        <div class="control">
          <div class="control-info">
            <div class="control-title">AQual Ring</div>
            <div class="control-subtitle">Pair your AQual Ring.</div>
          </div>
          <div class="control-actions column">
            <div class="control-actions ring-quick-actions">
              <button class="action-button" id="ringHidConnect">Connect ring</button>
              <button class="action-button" id="ringHidForget">Forget</button>
              <button class="action-button" id="ringHidSettingsToggle" type="button" aria-expanded="false">Settings</button>
            </div>
            <div class="ring-settings-panel" id="ringHidSettingsPanel" hidden>
              <div class="ring-settings-header">
                <div class="ring-settings-title">Ring Button Actions</div>
                <button class="action-button ring-settings-done" id="ringHidSettingsDone" type="button">Save</button>
              </div>
              <div class="ring-settings-row">
                <label class="ring-settings-label" for="ringButtonActionRight">Right</label>
                <select class="select ring-button-action-select" id="ringButtonActionRight" data-ring-button="right"></select>
              </div>
              <div class="ring-settings-row">
                <label class="ring-settings-label" for="ringButtonActionLeft">Left</label>
                <select class="select ring-button-action-select" id="ringButtonActionLeft" data-ring-button="left"></select>
              </div>
              <div class="ring-settings-row">
                <label class="ring-settings-label" for="ringButtonActionBottom">Bottom</label>
                <select class="select ring-button-action-select" id="ringButtonActionBottom" data-ring-button="bottom"></select>
              </div>
              <div class="ring-settings-row">
                <label class="ring-settings-label" for="ringButtonActionTop">Top</label>
                <select class="select ring-button-action-select" id="ringButtonActionTop" data-ring-button="top"></select>
              </div>
              <div class="ring-settings-row">
                <label class="ring-settings-label" for="ringButtonActionCenter">Centre</label>
                <select class="select ring-button-action-select" id="ringButtonActionCenter" data-ring-button="center"></select>
              </div>
              <div class="ring-settings-row">
                <label class="ring-settings-label" for="ringButtonActionHome">Home</label>
                <select class="select ring-button-action-select" id="ringButtonActionHome" data-ring-button="home"></select>
              </div>
            </div>
            <div class="status-text" id="ringHidStatus">Not connected. Press Connect and choose your ring.</div>
          </div>
        </div>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Night / reading mode</div>
            <div class="control-subtitle">Low-vision friendly dark theme.</div>
          </div>
          <div class="control-actions">
            <label class="switch">
              <input type="checkbox" id="nightModeEnabled" />
              <span class="switch-track"></span>
              <span class="switch-state" id="nightModeEnabledState">Off</span>
            </label>
          </div>
        </div>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Brightness dimming</div>
            <div class="control-subtitle">Reduce glare with an overlay.</div>
          </div>
          <div class="control-actions column">
            <div class="range">
              <input
                type="range"
                id="dimmingRange"
                min="0"
                max="70"
                step="5"
                value="25"
              />
              <div class="range-value" id="dimmingValue">25%</div>
            </div>
            <label class="switch">
              <input type="checkbox" id="dimmingEnabled" />
              <span class="switch-track"></span>
              <span class="switch-state" id="dimmingEnabledState">Off</span>
            </label>
          </div>
        </div>

        <div class="control">
          <div class="control-info">
            <div class="control-title">Blue-light filter</div>
            <div class="control-subtitle">Warm the screen to reduce strain.</div>
          </div>
          <div class="control-actions column">
            <div class="range">
              <input
                type="range"
                id="blueLightRange"
                min="0"
                max="60"
                step="5"
                value="20"
              />
              <div class="range-value" id="blueLightValue">20%</div>
            </div>
            <label class="switch">
              <input type="checkbox" id="blueLightEnabled" />
              <span class="switch-track"></span>
              <span class="switch-state" id="blueLightEnabledState">Off</span>
            </label>
          </div>
        </div>
        </details>

        <details class="group" id="section-utilities">
          <summary>Utilities</summary>
        <div class="control">
          <div class="control-info">
            <div class="control-title">Print page</div>
            <div class="control-subtitle">Open the print dialogue for this page.</div>
          </div>
          <div class="control-actions">
            <button class="action-button" id="printPage">Print</button>
          </div>
        </div>
        <div class="control">
          <div class="control-info">
            <div class="control-title">Screenshot</div>
            <div class="control-subtitle">Capture the visible area of the tab.</div>
          </div>
          <div class="control-actions">
            <button class="action-button" id="captureScreenshot">Capture</button>
          </div>
        </div>
        </details>

        <div class="footer">
          <button class="reset-button" id="toggleSections">Expand all</button>
          <button class="reset-button" id="resetDefaults">Reset to defaults</button>
        </div>
      </div>

      <div class="tab-panel" id="tab-audio">
        <div class="audio-card">
          <div class="audio-header">
            <div>
              <div class="audio-title">Live Transcription</div>
              <div class="audio-subtitle">ElevenLabs or Local Whisper</div>
            </div>
            <div class="audio-status">
              <span id="audioStatusText">Idle</span>
            </div>
          </div>

          <div class="audio-modes">
            <button class="mode-button active" data-mode="elevenlabs">ElevenLabs</button>
            <button class="mode-button" data-mode="local">Local Whisper</button>
          </div>

          <div class="audio-permission">
            <button class="ghost-button" id="audioPermission">Grant microphone access</button>
            <div class="audio-permission-note" id="audioPermissionNote">
              If mic access is blocked, open the permission page to grant it.
            </div>
          </div>

          <div class="audio-controls">
            <button class="action-button audio-start" id="audioStart">Start</button>
            <button class="action-button audio-stop" id="audioStop" disabled>Stop</button>
          </div>

          <canvas id="audioVisualizer" class="audio-visualizer"></canvas>

          <div class="audio-transcript" id="audioTranscript">Waiting for speech...</div>

        </div>
      </div>
    </main>
  </body>
</html>
